require 'spec_helper'

# TODO: REFACTOR
describe Stribog::Compression do
  context '256 bit hash, with 504 bit message' do
    let(:n) { Stribog::BinaryVector.new('00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'.chars.map(&:to_i)) }
    let(:message) { Stribog::BinaryVector.new('00000001001100100011000100110000001110010011100000110111001101100011010100110100001100110011001000110001001100000011100100111000001101110011011000110101001101000011001100110010001100010011000000111001001110000011011100110110001101010011010000110011001100100011000100110000001110010011100000110111001101100011010100110100001100110011001000110001001100000011100100111000001101110011011000110101001101000011001100110010001100010011000000111001001110000011011100110110001101010011010000110011001100100011000100110000'.chars.map(&:to_i)) }
    let(:hash_vector) { Stribog::BinaryVector.new('00000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001'.chars.map(&:to_i)) }

    subject { Stribog::Compression.new(n, message, hash_vector).call.to_s }

    it { should eq('11100011101110111010110110111111011110001010111100110010011001001100100100010011011100010010011101100000100010101010010100010000110111101001000010111010010011010011000001110101011001100101100001000100100101100101111110110110000100011101101110110001100110011000110101001000010101010010101000001100000011001110011010111100101110100111000110111100100000000010101001001111010110110010110100101010000001111011000100101100001000101110001001010111100101000001011110000101011100000011010000010000100101101111110111000111') }
  end

  context '256 bit hash, with 504 bit message' do
    let(:n) { Stribog::BinaryVector.new('00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'.chars.map(&:to_i)) }
    let(:message) { Stribog::BinaryVector.new('11111011111010101111101011101011111011110010000011111111111110111111000011100001111000001111000011110101001000001110000011101101001000001110100011101100111000001110101111100101111100001111001011110001001000001111111111110000111011101110110000100000111100010010000011111010111100101111111011100101111000100010000000101100111010001111011011110011111011011110001000100000111010001110011011101110111000011110100011110000111100101101000100100000001011001110100011110000111100101110010111100010001000001110010111010001'.chars.map(&:to_i)) }
    let(:hash_vector) { Stribog::BinaryVector.new('00000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001'.chars.map(&:to_i)) }

    subject { Stribog::Compression.new(n, message, hash_vector).call.to_s }

    it { should eq('00100000001111001100000101011101110101010101111111001010101001011011011110100011101111011001100011111011001001000000100010100110011111010101101110011111001100111010100000001011101101010000010101000000100001010010101100100000010000100110010110100010110000011010101011001010010111101111111000011101100011010101000110110010111000010110001101101110001101001111010110111110110011000000011101111101100100110000000100010100111111101111101011110001011101101011011010011100000101011010110110001111001010110110100001111000') }
  end
end